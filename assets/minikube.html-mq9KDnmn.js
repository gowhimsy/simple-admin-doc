import{_ as t}from"./plugin-vue_export-helper-x3n3nnut.js";import{r as l,o as c,c as p,a as s,f as a,b as e,e as i}from"./app-J34oMQ8k.js";const o={},r=s("h2",{id:"minikube-initialization",tabindex:"-1"},[s("a",{class:"header-anchor",href:"#minikube-initialization"},[s("span",null,"Minikube initialization")])],-1),d=s("h3",{id:"install",tabindex:"-1"},[s("a",{class:"header-anchor",href:"#install"},[s("span",null,"Install")])],-1),u={href:"https://minikube.sigs.k8s.io/docs/start/",target:"_blank",rel:"noopener noreferrer"},m=i(`<h3 id="start-minikube" tabindex="-1"><a class="header-anchor" href="#start-minikube"><span>Start minikube</span></a></h3><blockquote><p>Recommend to set the memory limit in local development，my setting is 3gb</p></blockquote><div class="language-bash line-numbers-mode" data-ext="sh" data-title="sh"><pre class="language-bash"><code>minikube start <span class="token parameter variable">--memory</span> 3g
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div></div></div><h3 id="minikube-add-plugins" tabindex="-1"><a class="header-anchor" href="#minikube-add-plugins"><span>minikube add plugins</span></a></h3><blockquote><p>Enable ingress adn metrics (metrics is used in go-zero for auto-scaling monitor)</p></blockquote><div class="language-bash line-numbers-mode" data-ext="sh" data-title="sh"><pre class="language-bash"><code>minikube addons <span class="token builtin class-name">enable</span> ingress
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div></div></div><h3 id="add-alias" tabindex="-1"><a class="header-anchor" href="#add-alias"><span>Add alias</span></a></h3><div class="language-bash line-numbers-mode" data-ext="sh" data-title="sh"><pre class="language-bash"><code><span class="token builtin class-name">alias</span> <span class="token assign-left variable">kubectl</span><span class="token operator">=</span><span class="token string">&quot;minikube kubectl --&quot;</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div></div></div><h3 id="deploy-the-service" tabindex="-1"><a class="header-anchor" href="#deploy-the-service"><span>Deploy the service</span></a></h3><blockquote><p>clone the code，cd deploy/k8s</p></blockquote><div class="language-bash line-numbers-mode" data-ext="sh" data-title="sh"><pre class="language-bash"><code><span class="token comment"># add service discovery account</span>
kubectl apply <span class="token parameter variable">-f</span> auth.yaml

<span class="token comment"># create persistent volume for log</span>
kubectl apply <span class="token parameter variable">-f</span> pv.yaml

<span class="token comment"># modify core-rpc.yaml to set your own image</span>
kubectl apply <span class="token parameter variable">-f</span> core-rpc.yaml

<span class="token comment"># modify core-api.yaml to set your own image</span>
kubectl apply <span class="token parameter variable">-f</span> core-api.yaml

<span class="token comment"># modify backend-ui.yaml to set your own image</span>
kubectl apply <span class="token parameter variable">-f</span> backend-ui.yaml
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><div class="hint-container info"><p class="hint-container-title">Info</p><p>You can just run simple-admin-core/deploy/k8s/setup.sh to finish the job.</p></div><h3 id="ingress-setting" tabindex="-1"><a class="header-anchor" href="#ingress-setting"><span>Ingress Setting</span></a></h3>`,13),v={href:"https://minikube.sigs.k8s.io/docs/tutorials/nginx_tcp_udp_ingress/",target:"_blank",rel:"noopener noreferrer"},b=i(`<h3 id="firstly-add-ingress" tabindex="-1"><a class="header-anchor" href="#firstly-add-ingress"><span>Firstly, add ingress</span></a></h3><div class="language-bash line-numbers-mode" data-ext="sh" data-title="sh"><pre class="language-bash"><code>kubectl apply <span class="token parameter variable">-f</span> ingress.yaml
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div></div></div><blockquote><p>Ingress.yaml file</p></blockquote><div class="language-yaml line-numbers-mode" data-ext="yml" data-title="yml"><pre class="language-yaml"><code><span class="token key atrule">apiVersion</span><span class="token punctuation">:</span> networking.k8s.io/v1
<span class="token key atrule">kind</span><span class="token punctuation">:</span> Ingress
<span class="token key atrule">metadata</span><span class="token punctuation">:</span>
  <span class="token key atrule">name</span><span class="token punctuation">:</span> simple<span class="token punctuation">-</span>admin<span class="token punctuation">-</span>ingress
  <span class="token key atrule">annotations</span><span class="token punctuation">:</span>
    <span class="token key atrule">nginx.ingress.kubernetes.io/rewrite-target</span><span class="token punctuation">:</span> /$1

<span class="token key atrule">spec</span><span class="token punctuation">:</span>
  <span class="token key atrule">rules</span><span class="token punctuation">:</span>
    <span class="token punctuation">-</span> <span class="token key atrule">host</span><span class="token punctuation">:</span> simple<span class="token punctuation">-</span>admin.com <span class="token comment"># your domain</span>
      <span class="token key atrule">http</span><span class="token punctuation">:</span>
        <span class="token key atrule">paths</span><span class="token punctuation">:</span>
          <span class="token punctuation">-</span> <span class="token key atrule">path</span><span class="token punctuation">:</span> /
            <span class="token key atrule">pathType</span><span class="token punctuation">:</span> Prefix
            <span class="token key atrule">backend</span><span class="token punctuation">:</span>
              <span class="token key atrule">service</span><span class="token punctuation">:</span>
                <span class="token key atrule">name</span><span class="token punctuation">:</span> backendui<span class="token punctuation">-</span>svc
                <span class="token key atrule">port</span><span class="token punctuation">:</span>
                  <span class="token key atrule">number</span><span class="token punctuation">:</span> <span class="token number">80</span>
    <span class="token punctuation">-</span> <span class="token key atrule">host</span><span class="token punctuation">:</span> simple<span class="token punctuation">-</span>admin.com <span class="token comment"># your domain</span>
      <span class="token key atrule">http</span><span class="token punctuation">:</span>
        <span class="token key atrule">paths</span><span class="token punctuation">:</span>
          <span class="token punctuation">-</span> <span class="token key atrule">path</span><span class="token punctuation">:</span> /sys<span class="token punctuation">-</span>api/
            <span class="token key atrule">pathType</span><span class="token punctuation">:</span> Prefix
            <span class="token key atrule">backend</span><span class="token punctuation">:</span>
              <span class="token key atrule">service</span><span class="token punctuation">:</span>
                <span class="token key atrule">name</span><span class="token punctuation">:</span> coreapi<span class="token punctuation">-</span>svc
                <span class="token key atrule">port</span><span class="token punctuation">:</span>
                  <span class="token key atrule">number</span><span class="token punctuation">:</span> <span class="token number">9100</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><h3 id="register-tcp-service-into-ingress-configmap" tabindex="-1"><a class="header-anchor" href="#register-tcp-service-into-ingress-configmap"><span>Register tcp service into ingress configmap</span></a></h3><div class="language-bash line-numbers-mode" data-ext="sh" data-title="sh"><pre class="language-bash"><code><span class="token comment"># register coreapi</span>
kubectl patch configmap tcp-services <span class="token parameter variable">-n</span> ingress-nginx <span class="token parameter variable">--patch</span> <span class="token string">&#39;{&quot;data&quot;:{&quot;9100&quot;:&quot;simple-admin/coreapi-svc:9100&quot;}}&#39;</span>
<span class="token comment"># register backendui, connect 8080 port to 80 in backendui service</span>
kubectl patch configmap tcp-services <span class="token parameter variable">-n</span> ingress-nginx <span class="token parameter variable">--patch</span> <span class="token string">&#39;{&quot;data&quot;:{&quot;8080&quot;:&quot;simple-admin/backendui-svc:80&quot;}}&#39;</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><h3 id="register-service-into-ingress-controller" tabindex="-1"><a class="header-anchor" href="#register-service-into-ingress-controller"><span>Register service into ingress controller</span></a></h3><div class="language-bash line-numbers-mode" data-ext="sh" data-title="sh"><pre class="language-bash"><code>kubectl patch deployment ingress-nginx-controller <span class="token parameter variable">--patch</span> <span class="token string">&quot;<span class="token variable"><span class="token variable">$(</span><span class="token function">cat</span> ingress-patch.yaml<span class="token variable">)</span></span>&quot;</span> <span class="token parameter variable">-n</span> ingress-nginx

</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div></div></div><div class="hint-container info"><p class="hint-container-title">Info</p><p>You can just run simple-admin-core/deploy/k8s/setup-ingress.sh to finish the job.</p></div><blockquote><p>browse ingress IP address</p></blockquote><div class="language-bash line-numbers-mode" data-ext="sh" data-title="sh"><pre class="language-bash"><code>kubectl get ingress
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div></div></div><blockquote><p>You can see</p></blockquote><div class="language-bash line-numbers-mode" data-ext="sh" data-title="sh"><pre class="language-bash"><code>NAME                   CLASS   HOSTS                               ADDRESS        PORTS   AGE
simple-admin-ingress   nginx   simple-admin.com,simple-admin.com   <span class="token number">192.168</span>.49.2   <span class="token number">80</span>      2m8s
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div></div></div><h3 id="modify-local-hosts" tabindex="-1"><a class="header-anchor" href="#modify-local-hosts"><span>Modify local hosts</span></a></h3><blockquote><p>ip is the same as ingress</p></blockquote><div class="language-bash line-numbers-mode" data-ext="sh" data-title="sh"><pre class="language-bash"><code><span class="token comment"># add dns</span>
<span class="token number">192.168</span>.49.2    simple-admin.com
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div></div></div><h3 id="visit-the-site" tabindex="-1"><a class="header-anchor" href="#visit-the-site"><span>Visit the site</span></a></h3><div class="language-bash line-numbers-mode" data-ext="sh" data-title="sh"><pre class="language-bash"><code>http://simple-admin.com:8080/
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div></div></div><blockquote><p>You can see the web page.</p></blockquote>`,19);function k(h,g){const n=l("ExternalLinkIcon");return c(),p("div",null,[r,d,s("p",null,[s("a",u,[a("Minikube Install"),e(n)])]),m,s("p",null,[a("Reference "),s("a",v,[a("Official Document"),e(n)])]),b])}const x=t(o,[["render",k],["__file","minikube.html.vue"]]);export{x as default};
