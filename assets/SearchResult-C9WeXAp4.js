import{u as I,g as Z,h as ee,i as U,j as te,k as ie,t as ae,l as ue,m as P,n as A,p as le,q as B,s as i,v as se,R as j,x as re,y as ce,z as oe,A as T,B as $,C as de,D as ne,E as he,F as ge,O as me,G as pe,H as fe,P as ve,I as ye,J as ke,K as R}from"./app-CVKe-WOh.js";const ze=["/","/guide/FAQ.html","/guide/","/guide/upgrade.html","/zh/","/guide/cicd/1-drone.html","/guide/cicd/2-gitlab.html","/guide/cicd/3-gitea.html","/guide/basic-config/all_in_one.html","/guide/basic-config/configurations.html","/guide/basic-config/doge.html","/guide/basic-config/env_setting.html","/guide/basic-config/global_vars.html","/guide/basic-config/quickcmd.html","/guide/basic-config/simple-admin-tools.html","/guide/basic-config/standard.html","/guide/basic-config/web-setting.html","/guide/community-comp/1-pay.html","/guide/feature/authorization.html","/guide/feature/error_handling.html","/guide/feature/i18n.html","/guide/feature/jwt_blacklist.html","/guide/feature/log-collection.html","/guide/feature/oauth.html","/guide/feature/prometheus.html","/guide/feature/swagger.html","/guide/feature/tracing_analysis.html","/guide/feature/validator.html","/guide/official-comp/cron.html","/guide/official-comp/file_manager.html","/guide/official-comp/member.html","/guide/official-comp/message_center.html","/guide/official-comp/vip.html","/guide/quick-start/process.html","/zh/guide/FAQ.html","/zh/guide/","/zh/guide/upgrade.html","/guide/basic-config/k8s/k8s-deploy.html","/guide/basic-config/k8s/minikube.html","/guide/feature/MQ/asynq.html","/guide/feature/MQ/rocketmq.html","/guide/feature/ORM/ent.html","/guide/feature/ORM/gorm.html","/guide/feature/Plugins/mongo.html","/guide/quick-start/codegen/api_example.html","/guide/quick-start/codegen/rpc_example.html","/guide/quick-start/codegen/web_codegen.html","/guide/quick-start/core/quick_develop_example.html","/guide/quick-start/core/web_develop_example.html","/guide/quick-start/extra/1-i18n.html","/guide/quick-start/extra/2-api_init_code.html","/guide/quick-start/extra/3-ent_template.html","/guide/quick-start/extra/4-docker.html","/guide/quick-start/extra/5-makefile.html","/guide/quick-start/extra/6-info.html","/guide/quick-start/extra/7-proto2api.html","/guide/quick-start/extra/8-log_viewer.html","/zh/guide/basic-config/all_in_one.html","/zh/guide/basic-config/configurations.html","/zh/guide/basic-config/doge.html","/zh/guide/basic-config/env_setting.html","/zh/guide/basic-config/global_vars.html","/zh/guide/basic-config/quickcmd.html","/zh/guide/basic-config/simple-admin-tools.html","/zh/guide/basic-config/standard.html","/zh/guide/basic-config/web-setting.html","/zh/guide/cicd/1-drone.html","/zh/guide/cicd/2-gitlab.html","/zh/guide/cicd/3-gitea.html","/zh/guide/community-comp/1-pay.html","/zh/guide/feature/authorization.html","/zh/guide/feature/error_handling.html","/zh/guide/feature/i18n.html","/zh/guide/feature/jwt_blacklist.html","/zh/guide/feature/log-collection.html","/zh/guide/feature/oauth.html","/zh/guide/feature/prometheus.html","/zh/guide/feature/swagger.html","/zh/guide/feature/tracing_analysis.html","/zh/guide/feature/validator.html","/zh/guide/official-comp/cron.html","/zh/guide/official-comp/file_manager.html","/zh/guide/official-comp/member.html","/zh/guide/official-comp/message_center.html","/zh/guide/official-comp/vip.html","/zh/guide/quick-start/process.html","/zh/guide/basic-config/k8s/k8s-deploy.html","/zh/guide/basic-config/k8s/minikube.html","/zh/guide/feature/MQ/asynq.html","/zh/guide/feature/MQ/rocketmq.html","/zh/guide/feature/ORM/ent.html","/zh/guide/feature/ORM/gorm.html","/zh/guide/feature/Plugins/mongo.html","/zh/guide/quick-start/codegen/api_example.html","/zh/guide/quick-start/codegen/rpc_example.html","/zh/guide/quick-start/codegen/web_codegen.html","/zh/guide/quick-start/core/quick_develop_example.html","/zh/guide/quick-start/core/web_develop_example.html","/zh/guide/quick-start/extra/1-i18n.html","/zh/guide/quick-start/extra/2-api_init_code.html","/zh/guide/quick-start/extra/3-ent_template.html","/zh/guide/quick-start/extra/4-docker.html","/zh/guide/quick-start/extra/5-makefile.html","/zh/guide/quick-start/extra/6-info.html","/zh/guide/quick-start/extra/7-proto2api.html","/zh/guide/quick-start/extra/8-log_viewer.html","/404.html","/guide/cicd/","/guide/basic-config/","/guide/community-comp/","/guide/feature/","/guide/official-comp/","/guide/quick-start/","/guide/basic-config/k8s/","/guide/feature/MQ/","/guide/feature/ORM/","/guide/feature/Plugins/","/guide/quick-start/codegen/","/guide/quick-start/core/","/guide/quick-start/extra/","/zh/guide/basic-config/","/zh/guide/cicd/","/zh/guide/community-comp/","/zh/guide/feature/","/zh/guide/official-comp/","/zh/guide/quick-start/","/zh/guide/basic-config/k8s/","/zh/guide/feature/MQ/","/zh/guide/feature/ORM/","/zh/guide/feature/Plugins/","/zh/guide/quick-start/codegen/","/zh/guide/quick-start/core/","/zh/guide/quick-start/extra/"],qe="SEARCH_PRO_QUERY_HISTORY",m=I(qe,[]),be=()=>{const{queryHistoryCount:a}=R,u=a>0;return{enabled:u,queryHistory:m,addQueryHistory:l=>{u&&(m.value.length<a?m.value=Array.from(new Set([l,...m.value])):m.value=Array.from(new Set([l,...m.value.slice(0,a-1)])))},removeQueryHistory:l=>{m.value=[...m.value.slice(0,l),...m.value.slice(l+1)]}}},D=a=>ze[a.id]+("anchor"in a?`#${a.anchor}`:""),_e="SEARCH_PRO_RESULT_HISTORY",{resultHistoryCount:O}=R,p=I(_e,[]),xe=()=>{const a=O>0;return{enabled:a,resultHistory:p,addResultHistory:u=>{if(a){const l={link:D(u),display:u.display};"header"in u&&(l.header=u.header),p.value.length<O?p.value=[l,...p.value]:p.value=[l,...p.value.slice(0,O-1)]}},removeResultHistory:u=>{p.value=[...p.value.slice(0,u),...p.value.slice(u+1)]}}},Re=a=>{const u=de(),l=U(),w=ne(),r=P(!1),y=he([]);return ge(()=>{const{search:q,terminate:f}=me(),b=()=>{y.value=[],r.value=!1},k=ke(d=>{const z=d.join(" "),{searchFilter:Q=g=>g,splitWord:H,suggestionsFilter:F,...v}=u.value;r.value=!0,z?q(d.join(" "),l.value,v).then(g=>Q(g,z,l.value,w.value)).then(g=>{y.value=g,r.value=!1}).catch(g=>{console.error(g),b()}):b()},R.searchDelay-R.suggestDelay);B([a,l],([d])=>k(d),{immediate:!0}),pe(()=>{f()})}),{searching:r,results:y}};var Qe=Z({name:"SearchResult",props:{queries:{type:Array,required:!0},isFocusing:Boolean},emits:["close","updateQuery"],setup(a,{emit:u}){const l=ee(),w=U(),r=te(ie),{enabled:y,addQueryHistory:q,queryHistory:f,removeQueryHistory:b}=be(),{enabled:k,resultHistory:d,addResultHistory:z,removeResultHistory:Q}=xe(),H=y||k,F=ae(a,"queries"),{results:v,searching:g}=Re(F),s=ue({isQuery:!0,index:0}),n=P(0),h=P(0),L=A(()=>H&&(f.value.length>0||d.value.length>0)),C=A(()=>v.value.length>0),M=A(()=>v.value[n.value]||null),Y=()=>{const{isQuery:e,index:t}=s;t===0?(s.isQuery=!e,s.index=e?d.value.length-1:f.value.length-1):s.index=t-1},G=()=>{const{isQuery:e,index:t}=s;t===(e?f.value.length-1:d.value.length-1)?(s.isQuery=!e,s.index=0):s.index=t+1},J=()=>{n.value=n.value>0?n.value-1:v.value.length-1,h.value=M.value.contents.length-1},K=()=>{n.value=n.value<v.value.length-1?n.value+1:0,h.value=0},V=()=>{h.value<M.value.contents.length-1?h.value+=1:K()},N=()=>{h.value>0?h.value-=1:J()},S=e=>e.map(t=>fe(t)?t:i(t[0],t[1])),W=e=>{if(e.type==="customField"){const t=ve[e.index]||"$content",[c,x=""]=ye(t)?t[w.value].split("$content"):t.split("$content");return e.display.map(o=>i("div",S([c,...o,x])))}return e.display.map(t=>i("div",S(t)))},_=()=>{n.value=0,h.value=0,u("updateQuery",""),u("close")};return le("keydown",e=>{if(a.isFocusing){if(C.value){if(e.key==="ArrowUp")N();else if(e.key==="ArrowDown")V();else if(e.key==="Enter"){const t=M.value.contents[h.value];q(a.queries.join(" ")),z(t),l.push(D(t)),_()}}else if(k){if(e.key==="ArrowUp")Y();else if(e.key==="ArrowDown")G();else if(e.key==="Enter"){const{index:t}=s;s.isQuery?(u("updateQuery",f.value[t]),e.preventDefault()):(l.push(d.value[t].link),_())}}}}),B([n,h],()=>{var e;(e=document.querySelector(".search-pro-result-list-item.active .search-pro-result-item.active"))==null||e.scrollIntoView(!1)},{flush:"post"}),()=>i("div",{class:["search-pro-result-wrapper",{empty:a.queries.length?!C.value:!L.value}],id:"search-pro-results"},a.queries.length?g.value?i(se,{hint:r.value.searching}):C.value?i("ul",{class:"search-pro-result-list"},v.value.map(({title:e,contents:t},c)=>{const x=n.value===c;return i("li",{class:["search-pro-result-list-item",{active:x}]},[i("div",{class:"search-pro-result-title"},e||r.value.defaultTitle),t.map((o,X)=>{const E=x&&h.value===X;return i(j,{to:D(o),class:["search-pro-result-item",{active:E,"aria-selected":E}],onClick:()=>{q(a.queries.join(" ")),z(o),_()}},()=>[o.type==="text"?null:i(o.type==="title"?re:o.type==="heading"?ce:oe,{class:"search-pro-result-type"}),i("div",{class:"search-pro-result-content"},[o.type==="text"&&o.header?i("div",{class:"content-header"},o.header):null,i("div",W(o))])])})])})):r.value.emptyResult:H?L.value?[y?i("ul",{class:"search-pro-result-list"},i("li",{class:"search-pro-result-list-item"},[i("div",{class:"search-pro-result-title"},r.value.queryHistory),f.value.map((e,t)=>i("div",{class:["search-pro-result-item",{active:s.isQuery&&s.index===t}],onClick:()=>{u("updateQuery",e)}},[i(T,{class:"search-pro-result-type"}),i("div",{class:"search-pro-result-content"},e),i("button",{class:"search-pro-remove-icon",innerHTML:$,onClick:c=>{c.preventDefault(),c.stopPropagation(),b(t)}})]))])):null,k?i("ul",{class:"search-pro-result-list"},i("li",{class:"search-pro-result-list-item"},[i("div",{class:"search-pro-result-title"},r.value.resultHistory),d.value.map((e,t)=>i(j,{to:e.link,class:["search-pro-result-item",{active:!s.isQuery&&s.index===t}],onClick:()=>{_()}},()=>[i(T,{class:"search-pro-result-type"}),i("div",{class:"search-pro-result-content"},[e.header?i("div",{class:"content-header"},e.header):null,i("div",e.display.map(c=>S(c)).flat())]),i("button",{class:"search-pro-remove-icon",innerHTML:$,onClick:c=>{c.preventDefault(),c.stopPropagation(),Q(t)}})]))])):null]:r.value.emptyHistory:r.value.emptyResult)}});export{Qe as default};
